---
layout: post
date: 2018-02-05
categories:
  - code
  - uibot
  - pixelspace
published: true
permalink: blog/pixelspace-and-uibot
headline: blog
heading: Pixelspace & UIBot
---
In this post I'll demostrate how two of my open source projects, [`Pixelspace`](https://github.com/jeremyfromearth/pixelspace) and [`UIBot`](https://github.com/jeremyfromearth/uibot) can be used together to create interactive visualizations in the browser. 

<style>
  .uibot-container {
    width: 100%;
    padding-bottom: 1em;
  }
</style>

<script>
require(['lib/pixelspace', 'lib/uibot', 'app/waves'], function(Pixelspace, uibot, Waves) {
  var canvas = document.getElementById('sketch');
  var uibot_container = document.getElementById('uibot');
  if(canvas) {
    var ctx = canvas.getContext('2d');
    console.log(Waves)
    var renderer = new Waves(ctx);
    player = new Pixelspace.Player(canvas);
    player.setRenderer(renderer);
    player.init();
    player.play();

    var params = [{
      waveform: {
        options: ['Sine', 'Square', 'Triangle']
      },
      freq: {
        label: 'Frequency',
        min: 1,
        max: 30
      }, 
      defaults: [
        'amplitude', 
        'animating'
      ],
      reset: {
        label: 'Phase Reset'
      },
    }];

    var uibot = UIBot();
    uibot.build(renderer, params, uibot_container); 
    uibot.bind();
  }
});
</script>

<canvas id='sketch' width="1024" height="256"></canvas>
<div id='uibot' class='uibot-container'></div>

In the above sketch, the wave forms are rendered to an HTML5 Canvas using Pixelspace and the control interface below it is dynamically created by UIBot. 

The sketch is a subclass of the `Pixelspace.Renderer` class. Below is some pseudo-code for it: 

```
class Waveforms extends Pixelspace.Renderer {
  constructor() {
    this.amplitude = 0.5;
    this.frequency = 2;
    this.animating = true;
    this.phase = 0;
    this.waveform = 'Triangle';
  }

  step() {
    // update variables
  }

  render() {
    // draw graphics
  }
}
```

There is clearly more going on in the actual sketch than is listed in the psuedo-code above, but the important thing to see is that the `Waveforms` class has several variables that we'll want to expose to `UIBot`. To do that, we define a parameters object that describes what properties of the sketch we want UIBot to create controls for and a few optional details pertaining to those controls. Here is the actual object used to create the user interface: 

```
var params = [{
  waveform: {
    options: ['Sine', 'Square', 'Triangle']
  },
  freq: {
    label: 'Frequency',
    min: 1,
    max: 30
  }, 
  defaults: [
    'amplitude', 
    'animating'
  ],
  reset: {
    label: 'Phase Reset'
  },
}];
```

UIBot will use the data-type of each variable to create an appropriate user interface component. In the case of the `waveform` property, the data-type is `String`. However, because an `options` list is provided to the parameter, a select box is created. The field called `defaults` just tells UIBot to include the properties listed in the `defaults` list, in the interface, but that there are no special details it needs to know about them. UIBot will simply create default components for those properties. Now that the sketch is ready and the params object is defined, the only thing left to do is to tell UIBot to generate the controls and bind them to the sketch. This is accomplished with the following:

```
// ctx is an instance of the Canvas 2D Drawing Context
var container = document.getElementById('uibot');
var renderer = new Waves(ctx);
UIBot().build(renderer, params, container);
```

The interface generated by UIBot is designed to be responsive and will scale to fit the container it is added to. Additionally, the look and feel of the interface can be fully customized with CSS. Controls can also be arranged into rows by moving variable descriptors in the params object into multiple objects. Here is an example that would put the waveform and frequency controls on one row and the rest of them on a second row:

```
var params = [{
    // row 1
    waveform: {
      options: ['Sine', 'Square', 'Triangle']
    },
    freq: {
      label: 'Frequency',
      min: 1,
      max: 30
    }, 
  }, {
    // row 2
    defaults: [
      'amplitude', 
      'animating'
    ],
    reset: {
      label: 'Phase Reset'
    }
  }
}];
```

Well, that about covers the basics of using `Pixelspace` and `UIBot` together. I'm looking foward to using these tools in up-coming posts to help visulaize and explain some of the other work I've been doing. Stay tuned...
